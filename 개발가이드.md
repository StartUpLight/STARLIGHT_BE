# StarLight 개발가이드

## 아키텍처
- 헥사고날 아키텍처
- 도메인 모델 패턴

### 계층
- Domain Layer
- Application Layer
- Adapter Layer

> 외부(Actor) -> 어댑터 -> 애플리케이션 -> 도메인

## 패키지
- domain
- application
    - required
    - provided
- adapter
    - webapi
    - persistence
    - integration
    - security
- shared
- bootstrap

## 유의사항
- 어댑터는 항상 포트(인터페이스)에만 의존한다.
- 어댑터 ↔ 어댑터 직접 의존 금지 (필요하면 새 포트를 애플리케이션에 정의).
- Inbound `provided`는 해당 도메인의 유스케이스만 노출한다.
- Outbound 포트는 소비자 도메인에서 정의한다(`application/<domain>/required`).
- Cross-domain 조회는 `OtherDomainLookupPort` 규칙을 따른다.
- 다른 도메인의 `provided` 서비스를 직접 호출하지 않는다. 소비자 도메인에 `required` 포트를 정의하고, 제공 도메인의 어댑터가 구현한다.
- Response DTO는 애플리케이션 DTO로만 변환하고 엔티티를 직접 받지 않는다.
- 도메인 의미가 있는 포트는 소비자 도메인 `required`에 둔다.
- 순수 인프라 포트는 shared/infrastructure 패키지로 분리할 수 있다.

## 네이밍 규칙 요약
- Provided (inbound): `*UseCase`
- Required (outbound): `*Port`
- Cross-domain lookup: `OtherDomainLookupPort`
- 컬렉션을 함께 로딩하는 경우 이름에 컬렉션을 명시한다.
  - 예: `findAllWithCareersTagsCategories`, `findByIdWithCareersAndTags`
  - 예: `fetchExpertsWithCareersByIds`
- 영속성/조회 메서드의 실패-강제 조회는 `findByIdOrThrow`로 통일한다( `getOrThrow` 금지 ).
- 조회 동작은 `find*`로 통일한다(서비스/포트/어댑터). `get*`은 DTO getter 등 의미가 명확한 경우만 사용한다.
- 실패 동작을 이름으로 드러낸다.
  - Optional/nullable 반환: `findById`, `findByEmail`
  - 예외를 던짐: `findByIdOrThrow`, `findByTokenOrThrow`
  - 연관 강제 로딩: `findByIdWithCareersAndTags`, `fetchExpertsWithTagsByIds`

## 로컬 실행
- `./gradlew bootRun --args='--spring.profiles.active=dev'`
